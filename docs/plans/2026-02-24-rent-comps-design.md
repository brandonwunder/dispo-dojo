# Rent Comps Page — Design Document
Date: 2026-02-24

## Overview

Add a "Rent Comps" page to the Resources section of the Dispo Dojo sidebar. The page allows users to enter a property address and generate a free, one-page rental comp report covering all four investment strategies: Long-Term Rental (LTR), Section 8, Midterm Rental (MTR), and Short-Term Rental (STR).

All data is sourced from free, zero-signup APIs and web scraping. The page includes a prominent disclaimer that this is a free estimation tool and users should cross-verify. A CTA links to the Underwriting page for professional analysis.

---

## Data Sources (All Free, Zero Signup)

| Data | Source | Method |
|---|---|---|
| Rental comp listings (LTR) | HomeHarvest (`listing_type="for_rent"`) | Python library already installed |
| Section 8 FMR | HUD Fair Market Rents API | Free government REST API, no key |
| Geocoding | Nominatim (OpenStreetMap) | Free, no key |
| Major road detection | Overpass API (OpenStreetMap) | Free, no key — query road types near path |
| MTR estimate | LTR comps × 1.15–1.25 premium | Formula derivation |
| STR estimate | LTR monthly ÷ 21 × 1.6–2.0 multiplier × 0.72 occupancy | Formula derivation |

---

## Comp Filter Criteria (Industry Standard REI)

Applied to all HomeHarvest rental results before displaying:

1. **Property type match** — same type as subject (SFH, duplex, apartment, etc.)
2. **Bedroom count** — within ±1 bed of subject
3. **Square footage** — within ±25% of subject sqft
4. **Year built** — within 20 years of subject
5. **Geographic radius** — within 0.5-mile radius of subject address
6. **No major road crossing** — comps where the straight-line path crosses OSM road types `motorway`, `trunk`, `primary`, `secondary` are excluded (keeps comps in the same neighborhood)
7. **Listing recency** — active within last 90 days

Target: 3–5 filtered comps displayed. If fewer than 3 pass all filters, relax bedroom and sqft criteria incrementally.

---

## Page Layout

### Input Form (top of page)
- Property address (text input, required)
- Bedrooms (number, required)
- Bathrooms (number)
- Square footage (number)
- Year built (number)
- Property type (dropdown: SFH, Duplex, Triplex, Quadplex, Apartment/Condo)
- CTA: "Generate Rent Comps Report" button (headband red gradient)

### Disclaimer Banner
- Warning icon + text: "Free scraping tool — data sourced from public listings and government APIs. Always cross-verify before making investment decisions."
- Inline CTA: "For a professional underwriting analysis → Free Underwriting Service ↗" (links to /underwriting)

### Report Output (appears after generation)
1. **Executive Summary** — address, all 4 strategy monthly estimates at a glance, recommended strategy callout
2. **Long-Term Rental Section** — comp cards (address, beds/baths, sqft, rent, $/sqft, distance, days on market), adjusted rent estimate with confidence range
3. **Section 8 Section** — HUD FMR for ZIP by bedroom count, payment standard, utility allowance note, Section 8 pros/cons
4. **Midterm Rental Section** — LTR-derived premium, target tenant profiles (traveling nurses, corporate relocation, construction crews), estimated monthly
5. **Short-Term Rental Section** — formula-derived daily rate, 72% occupancy assumption, projected monthly/annual gross, Airbnb fee note, disclaimer that numbers are formula-based
6. **Strategy Comparison Table** — side-by-side: annual gross, risk level, effort level, ideal use case, recommended for scenario

### Download Button
- "Download PDF Report" — generates PDF via jsPDF + html2canvas of the full report section

---

## Report PDF Structure

Single-page (scrollable) branded PDF:
- Dispo Dojo header with property address
- All 6 sections above
- Footer: "Generated by Dispo Dojo • Free estimation tool • Always cross-verify"
- Generation date + data sources noted

---

## Backend Endpoint

**File:** `agent_finder/scrapers/rent_comps.py`

**Route:** `GET /api/rent-comps`

**Query params:**
- `address` (required)
- `beds` (required)
- `baths`
- `sqft`
- `year_built`
- `property_type`

**Response JSON:**
```json
{
  "subject": { "address": "...", "coords": [lat, lng], "zip": "..." },
  "comps": [
    {
      "address": "...",
      "beds": 3,
      "baths": 2,
      "sqft": 1400,
      "monthly_rent": 1850,
      "rent_per_sqft": 1.32,
      "distance_miles": 0.3,
      "days_on_market": 14,
      "listing_url": "..."
    }
  ],
  "estimates": {
    "ltr_monthly": 1875,
    "ltr_confidence": "medium",
    "section8_fmr": 1650,
    "section8_payment_standard": 1815,
    "mtr_monthly": 2160,
    "mtr_premium_pct": 15,
    "str_daily_rate": 112,
    "str_monthly_gross": 2419,
    "str_occupancy_assumed": 0.72
  },
  "hud": {
    "zip": "...",
    "county": "...",
    "fmr_0br": 950,
    "fmr_1br": 1100,
    "fmr_2br": 1350,
    "fmr_3br": 1650,
    "fmr_4br": 1900
  },
  "meta": {
    "comps_found": 4,
    "comps_filtered": 2,
    "filter_relaxed": false,
    "data_source": "HomeHarvest + HUD FMR API",
    "generated_at": "2026-02-24T..."
  }
}
```

---

## Frontend Files

- **Page:** `frontend/src/pages/RentComps.jsx`
- **Route:** `/rent-comps` (added to App.jsx)
- **Sidebar:** Resources section, icon: `BarChart3` from lucide-react, label: "Rent Comps"

**Dependencies to install:**
- `jspdf` — PDF generation
- `html2canvas` — screenshot report div for PDF

---

## Admin Page Update

Add a new "Upgrade Roadmap" section to `AdminDashboard.jsx`:

**Paid Upgrade Items:**
- **Rental Comps API** — Rentcast Pro or AirDNA: Replace formula-derived STR/MTR estimates with real market data. Priority: HIGH.
- Others TBD as product grows

---

## Design System

Follows existing Dispo Dojo Electric Ninja theme:
- Containers: `GlassCard` components with `border-[rgba(0,198,255,0.12)]`
- Section headers: Rajdhani font, gold (`#F6C445`) color, uppercase tracking
- Comp cards: elevated glassmorphism surface, cyan accent borders
- Strategy comparison: `ShojiCard` or custom table with color-coded risk/effort badges
- Primary CTA: headband red gradient (`#E53935 → #B3261E`)
- Download button: gold gradient
- Loading state: `ShurikenLoader`
- Disclaimer banner: amber/gold background with warning icon

---

## Out of Scope (v1)

- Real Airbnb/VRBO listing data (requires AirDNA or similar paid API)
- Map rendering (address-based comp cards sufficient for v1)
- Saving reports to user's account
- Batch address processing
